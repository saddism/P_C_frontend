(function(){"use strict";var e={3327:function(e,r,t){var a=t(5130),o=t(6768);function n(e,r,t,a,n,l){const i=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.Wv)(i)}var l={name:"App"},i=t(1241);const s=(0,i.A)(l,[["render",n]]);var u=s,c=t(1387),d=(t(4114),t(4232));const m={class:"register-container"};function f(e,r,t,a,n,l){const i=(0,o.g2)("el-input"),s=(0,o.g2)("el-form-item"),u=(0,o.g2)("el-button"),c=(0,o.g2)("el-form"),f=(0,o.g2)("el-card");return(0,o.uX)(),(0,o.CE)("div",m,[(0,o.bF)(f,{class:"register-card"},{default:(0,o.k6)((()=>[r[7]||(r[7]=(0,o.Lk)("h2",null,"用户注册",-1)),(0,o.bF)(c,{ref:"registerForm",model:a.form,rules:a.rules,"label-width":"80px",class:"register-form"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{label:"邮箱",prop:"email"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{modelValue:a.form.email,"onUpdate:modelValue":r[0]||(r[0]=e=>a.form.email=e),type:"email",placeholder:"请输入邮箱","data-test":"email-input"},null,8,["modelValue"])])),_:1}),(0,o.bF)(s,{label:"用户名",prop:"username"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{modelValue:a.form.username,"onUpdate:modelValue":r[1]||(r[1]=e=>a.form.username=e),placeholder:"请输入用户名","data-test":"username-input"},null,8,["modelValue"])])),_:1}),(0,o.bF)(s,{label:"密码",prop:"password"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{modelValue:a.form.password,"onUpdate:modelValue":r[2]||(r[2]=e=>a.form.password=e),type:"password",placeholder:"请输入密码","data-test":"password-input"},null,8,["modelValue"])])),_:1}),a.showVerificationCode?((0,o.uX)(),(0,o.Wv)(s,{key:0,label:"验证码",prop:"code"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{modelValue:a.form.code,"onUpdate:modelValue":r[3]||(r[3]=e=>a.form.code=e),placeholder:"请输入验证码","data-test":"code-input"},{append:(0,o.k6)((()=>[(0,o.bF)(u,{disabled:a.countdown>0,onClick:a.handleSendCode,"data-test":"send-code-button"},{default:(0,o.k6)((()=>[(0,o.eW)((0,d.v_)(a.countdown>0?`${a.countdown}秒后重试`:"获取验证码"),1)])),_:1},8,["disabled","onClick"])])),_:1},8,["modelValue"])])),_:1})):(0,o.Q3)("",!0),(0,o.bF)(s,null,{default:(0,o.k6)((()=>[(0,o.bF)(u,{type:"primary",onClick:a.handleRegister,loading:a.loading,"data-test":"register-button"},{default:(0,o.k6)((()=>r[5]||(r[5]=[(0,o.eW)(" 注册 ")]))),_:1},8,["onClick","loading"]),(0,o.bF)(u,{onClick:r[4]||(r[4]=r=>e.$router.push({path:"/login",query:e.$route.query}))},{default:(0,o.k6)((()=>r[6]||(r[6]=[(0,o.eW)("返回登录")]))),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1})])}var p=t(144),g=t(1219),b=(t(4603),t(7566),t(8721),t(4373));const h="https://auth-api-nvdempim.fly.dev",v=()=>"1"===new URLSearchParams(window.location.search).get("mock"),k=b.A.create({baseURL:v()?"":h});k.interceptors.response.use((e=>e),(e=>e.response?Promise.reject(e):Promise.reject(new Error("网络错误，请稍后重试"))));var y={name:"UserRegister",setup(){const e=(0,c.rd)(),r=(0,p.KR)(null),t=(0,p.KR)(!1),a=(0,p.KR)(!1),o=(0,p.KR)(0),n=(0,p.Kh)({email:"",username:"",password:"",code:""}),l={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在3到20个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:8,message:"密码长度至少为8个字符",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{len:6,message:"验证码长度为6位",trigger:"blur"}]},i=()=>{o.value=60;const e=setInterval((()=>{o.value--,o.value<=0&&clearInterval(e)}),1e3)},s=async()=>{try{const e=await k.post("https://auth-api-nvdempim.fly.dev/api/auth/resend-verification",{email:n.email});200===e.data.status&&(i(),a.value=!0,g.nk.success("验证码已发送，请查收邮件"))}catch(e){g.nk.error("发送验证码失败，请重试")}},u=async()=>{r.value&&await r.value.validate((async r=>{if(r){t.value=!0;try{const r=await k.post("https://auth-api-nvdempim.fly.dev/api/auth/register",n);201===r.data.status&&(g.nk.success("注册成功"),await e.push({path:"/register-success",query:{email:n.email}}))}catch(a){const e=a.response?.data?.message||"注册失败，请重试";g.nk.error(e)}finally{t.value=!1}}}))};return{registerForm:r,form:n,rules:l,loading:t,showVerificationCode:a,countdown:o,handleSendCode:s,handleRegister:u}}};const w=(0,i.A)(y,[["render",f],["__scopeId","data-v-7201c317"]]);var F=w;const _={class:"login-container"};function C(e,r,t,a,n,l){const i=(0,o.g2)("el-input"),s=(0,o.g2)("el-form-item"),u=(0,o.g2)("el-button"),c=(0,o.g2)("el-form"),d=(0,o.g2)("el-card");return(0,o.uX)(),(0,o.CE)("div",_,[(0,o.bF)(d,{class:"login-card"},{default:(0,o.k6)((()=>[r[5]||(r[5]=(0,o.Lk)("h2",null,"用户登录",-1)),(0,o.bF)(c,{ref:"loginForm",model:a.form,rules:a.rules,"label-width":"80px",class:"login-form"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{label:"邮箱",prop:"email"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{modelValue:a.form.email,"onUpdate:modelValue":r[0]||(r[0]=e=>a.form.email=e),type:"email",placeholder:"请输入邮箱","data-test":"email-input"},null,8,["modelValue"])])),_:1}),(0,o.bF)(s,{label:"密码",prop:"password"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{modelValue:a.form.password,"onUpdate:modelValue":r[1]||(r[1]=e=>a.form.password=e),type:"password",placeholder:"请输入密码","data-test":"password-input"},null,8,["modelValue"])])),_:1}),(0,o.bF)(s,null,{default:(0,o.k6)((()=>[(0,o.bF)(u,{type:"primary",onClick:a.handleLogin,loading:a.loading,"data-test":"login-button"},{default:(0,o.k6)((()=>r[3]||(r[3]=[(0,o.eW)(" 登录 ")]))),_:1},8,["onClick","loading"]),(0,o.bF)(u,{onClick:r[2]||(r[2]=r=>e.$router.push({path:"/register",query:e.$route.query}))},{default:(0,o.k6)((()=>r[4]||(r[4]=[(0,o.eW)("注册账号")]))),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1})])}var V={name:"UserLogin",setup(){const e=(0,c.rd)(),r=(0,p.KR)(null),t=(0,p.KR)(!1),a=(0,p.Kh)({email:"",password:""}),o={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},n=async()=>{if(r.value)try{const o=await new Promise((e=>{r.value.validate((r=>e(r)))})).catch((()=>!1));if(!o)return void g.nk.error("请检查输入信息");t.value=!0;const n=await k.post("https://auth-api-nvdempim.fly.dev/api/auth/login",a);if(200===n.data.status){const{access_token:r}=n.data;localStorage.setItem("token",r),g.nk.success("登录成功"),await e.push({path:"/",query:{}})}}catch(o){const e=o.response?.data?.message||"登录失败，请重试";g.nk.error(e)}finally{t.value=!1}else g.nk.error("表单验证失败")};return{loginForm:r,form:a,rules:o,loading:t,handleLogin:n}}};const q=(0,i.A)(V,[["render",C],["__scopeId","data-v-7f2138c0"]]);var E=q;const j={class:"success-container"};function O(e,r,t,a,n,l){const i=(0,o.g2)("el-button"),s=(0,o.g2)("el-result"),u=(0,o.g2)("el-card");return(0,o.uX)(),(0,o.CE)("div",j,[(0,o.bF)(u,{class:"success-card"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{icon:"success",title:"注册成功","sub-title":"请前往邮箱完成验证"},{extra:(0,o.k6)((()=>[(0,o.bF)(i,{type:"primary",onClick:l.resendVerification},{default:(0,o.k6)((()=>r[1]||(r[1]=[(0,o.eW)(" 重新发送验证邮件 ")]))),_:1},8,["onClick"]),(0,o.bF)(i,{onClick:r[0]||(r[0]=r=>e.$router.push("/login"))},{default:(0,o.k6)((()=>r[2]||(r[2]=[(0,o.eW)(" 返回登录 ")]))),_:1})])),_:1})])),_:1})])}var R={name:"RegisterSuccess",methods:{async resendVerification(){try{const e=this.$route.query.email;if(!e)return void g.nk.error("邮箱地址缺失");const r=await k.post("/api/auth/resend-verification",{email:e});200===r.status&&g.nk.success("验证邮件已重新发送")}catch(e){g.nk.error("发送失败，请重试")}}}};const A=(0,i.A)(R,[["render",O],["__scopeId","data-v-2ab1fccf"]]);var L=A;const U={class:"verify-container"};function x(e,r,t,a,n,l){const i=(0,o.g2)("el-input"),s=(0,o.g2)("el-form-item"),u=(0,o.g2)("el-button"),c=(0,o.g2)("el-form"),d=(0,o.g2)("el-card");return(0,o.uX)(),(0,o.CE)("div",U,[(0,o.bF)(d,{class:"verify-card"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{ref:"verifyForm",model:n.form,rules:n.rules,"label-width":"120px",class:"verify-form"},{default:(0,o.k6)((()=>[r[4]||(r[4]=(0,o.Lk)("h2",null,"邮箱验证",-1)),(0,o.bF)(s,{label:"邮箱",prop:"email"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{modelValue:n.form.email,"onUpdate:modelValue":r[0]||(r[0]=e=>n.form.email=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,o.bF)(s,{label:"验证码",prop:"code"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{modelValue:n.form.code,"onUpdate:modelValue":r[1]||(r[1]=e=>n.form.code=e),placeholder:"请输入验证码"},null,8,["modelValue"])])),_:1}),(0,o.bF)(s,null,{default:(0,o.k6)((()=>[(0,o.bF)(u,{type:"primary",onClick:l.submitForm},{default:(0,o.k6)((()=>r[2]||(r[2]=[(0,o.eW)("验证")]))),_:1},8,["onClick"]),(0,o.bF)(u,{onClick:l.resendCode},{default:(0,o.k6)((()=>r[3]||(r[3]=[(0,o.eW)("重新发送验证码")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])}var S={name:"VerifyEmail",data(){return{form:{email:"",code:""},rules:{email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{min:6,max:6,message:"验证码长度为6位",trigger:"blur"}]}}},created(){this.form.email=this.$route.query.email||""},methods:{async submitForm(){try{await this.$refs.verifyForm.validate();const e=await k.post("/api/auth/verify-email",this.form);200===e.status&&(g.nk.success("邮箱验证成功"),this.$router.push("/login"))}catch(e){422===e.response?.status?g.nk.error("验证失败：验证码无效"):g.nk.error("验证失败，请重试")}},async resendCode(){try{const e=await k.post("/api/auth/resend-verification",{email:this.form.email});200===e.status&&g.nk.success("验证码已重新发送")}catch(e){g.nk.error("发送失败，请重试")}}}};const W=(0,i.A)(S,[["render",x],["__scopeId","data-v-04607c14"]]);var P=W;const $=[{path:"/",redirect:"/login"},{path:"/register",name:"Register",component:F},{path:"/login",name:"Login",component:E},{path:"/register-success",name:"RegisterSuccess",component:L},{path:"/verify-email",name:"VerifyEmail",component:P}],K=(0,c.aE)({history:(0,c.LA)("/"),routes:$});K.beforeEach(((e,r)=>{if(r.query.mock&&!e.query.mock)return{path:e.path,query:{...e.query,mock:"1"}}}));var I=K,T=t(807);t(4188);v()&&t.e(738).then(t.bind(t,8738));const X=(0,a.Ef)(u);X.use(I).use(T.A).mount("#app")}},r={};function t(a){var o=r[a];if(void 0!==o)return o.exports;var n=r[a]={exports:{}};return e[a].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(r,a,o,n){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],o=e[c][1],n=e[c][2];for(var i=!0,s=0;s<a.length;s++)(!1&n||l>=n)&&Object.keys(t.O).every((function(e){return t.O[e](a[s])}))?a.splice(s--,1):(i=!1,n<l&&(l=n));if(i){e.splice(c--,1);var u=o();void 0!==u&&(r=u)}}return r}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,o,n]}}(),function(){t.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(r,{a:r}),r}}(),function(){t.d=function(e,r){for(var a in r)t.o(r,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:r[a]})}}(),function(){t.f={},t.e=function(e){return Promise.all(Object.keys(t.f).reduce((function(r,a){return t.f[a](e,r),r}),[]))}}(),function(){t.u=function(e){return"js/"+e+".7dec36e1.js"}}(),function(){t.miniCssF=function(e){}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)}}(),function(){var e={},r="pc-frontend:";t.l=function(a,o,n,l){if(e[a])e[a].push(o);else{var i,s;if(void 0!==n)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==r+n){i=d;break}}i||(s=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,t.nc&&i.setAttribute("nonce",t.nc),i.setAttribute("data-webpack",r+n),i.src=a),e[a]=[o];var m=function(r,t){i.onerror=i.onload=null,clearTimeout(f);var o=e[a];if(delete e[a],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach((function(e){return e(t)})),r)return r(t)},f=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),s&&document.head.appendChild(i)}}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.p="/"}(),function(){var e={524:0};t.f.j=function(r,a){var o=t.o(e,r)?e[r]:void 0;if(0!==o)if(o)a.push(o[2]);else{var n=new Promise((function(t,a){o=e[r]=[t,a]}));a.push(o[2]=n);var l=t.p+t.u(r),i=new Error,s=function(a){if(t.o(e,r)&&(o=e[r],0!==o&&(e[r]=void 0),o)){var n=a&&("load"===a.type?"missing":a.type),l=a&&a.target&&a.target.src;i.message="Loading chunk "+r+" failed.\n("+n+": "+l+")",i.name="ChunkLoadError",i.type=n,i.request=l,o[1](i)}};t.l(l,s,"chunk-"+r,r)}},t.O.j=function(r){return 0===e[r]};var r=function(r,a){var o,n,l=a[0],i=a[1],s=a[2],u=0;if(l.some((function(r){return 0!==e[r]}))){for(o in i)t.o(i,o)&&(t.m[o]=i[o]);if(s)var c=s(t)}for(r&&r(a);u<l.length;u++)n=l[u],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(c)},a=self["webpackChunkpc_frontend"]=self["webpackChunkpc_frontend"]||[];a.forEach(r.bind(null,0)),a.push=r.bind(null,a.push.bind(a))}();var a=t.O(void 0,[504],(function(){return t(3327)}));a=t.O(a)})();
//# sourceMappingURL=app.d830c6f6.js.map